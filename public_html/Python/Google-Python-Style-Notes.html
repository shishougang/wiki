<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Google Python Style Notes (Revision 2.59)</title>
<!-- 2016-02-03 Wed 22:49 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Shi Shougang" />
<link href="../assets/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="../assets/bootstrap-responsive.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../assets/stylesheet.css" />
<script src="assets/js/bootstrap.min.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Google Python Style Notes (Revision 2.59)</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Homepage</a></li>
<li><a href="#sec-2">Python Language Rules</a>
<ul>
<li><a href="#sec-2-1">Lint</a></li>
<li><a href="#sec-2-2">Imports</a></li>
<li><a href="#sec-2-3">Packages</a></li>
<li><a href="#sec-2-4">Exceptions</a></li>
<li><a href="#sec-2-5">Global variables</a></li>
<li><a href="#sec-2-6">Nested/Local/Inner Classes and Functions</a></li>
<li><a href="#sec-2-7">List Comprehensions</a></li>
<li><a href="#sec-2-8">Default Iterators and Operators</a></li>
<li><a href="#sec-2-9">Generators</a></li>
<li><a href="#sec-2-10">Lambda Functions</a></li>
<li><a href="#sec-2-11">Conditional Expressions</a></li>
<li><a href="#sec-2-12">Default Argument Values</a></li>
<li><a href="#sec-2-13">Properties</a></li>
<li><a href="#sec-2-14">True/False evaluations</a></li>
<li><a href="#sec-2-15">Deprecated Language Features</a></li>
<li><a href="#sec-2-16">Lexical Scoping</a></li>
<li><a href="#sec-2-17">Function and Method Decorators</a></li>
<li><a href="#sec-2-18">Threading</a></li>
<li><a href="#sec-2-19">Power Features</a></li>
</ul>
</li>
<li><a href="#sec-3">Python Style Rules</a>
<ul>
<li><a href="#sec-3-1">Semicolons</a></li>
<li><a href="#sec-3-2">Line length</a></li>
<li><a href="#sec-3-3">Parentheses</a></li>
<li><a href="#sec-3-4">Indentation</a></li>
<li><a href="#sec-3-5">Blank Lines</a></li>
<li><a href="#sec-3-6">Whitespace</a></li>
<li><a href="#sec-3-7">Shebang Line</a></li>
<li><a href="#sec-3-8">Comments</a></li>
<li><a href="#sec-3-9">Classes</a></li>
<li><a href="#sec-3-10">Strings</a></li>
<li><a href="#sec-3-11">Files and Sockets</a></li>
<li><a href="#sec-3-12"><span class="todo TODO">TODO</span> Comments</a></li>
<li><a href="#sec-3-13">Imports formatting</a></li>
<li><a href="#sec-3-14">Statements</a></li>
<li><a href="#sec-3-15">Access Control</a></li>
<li><a href="#sec-3-16">Naming</a></li>
<li><a href="#sec-3-17">Main</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Homepage</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>en: <a href="http://google-styleguide.googlecode.com/svn/trunk/pyguide.html">http://google-styleguide.googlecode.com/svn/trunk/pyguide.html</a>
</li>
<li>zh: <a href="http://zh-google-styleguide.readthedocs.org/en/latest/google-python-styleguide/python_language_rules/">http://zh-google-styleguide.readthedocs.org/en/latest/google-python-styleguide/python_language_rules/</a>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Python Language Rules</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Lint</h3>
<div class="outline-text-3" id="text-2-1">
<p class="info">
对你的代码运行pylint.
</p>

<p>
Suppress warnings if they are inappropriate so that other issues are
not hidden.
</p>

<p>
To suppress warnings, you can set a line-level comment:
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #b0c4de;">dict</span> = <span style="color: #ffa07a;">'something awful'</span>  <span style="color: #ff7f24;"># Bad Idea... pylint: disable=redefined-builtin</span>
</pre>
</div>
<p>
pylint warnings are each identified by a alphanumeric code (C0112) and a symbolic name (empty-docstring). Prefer the symbolic names in new code or when updating existing code.
</p>

<p>
If the reason for the suppression is not clear from the symbolic name, add an explanation.
</p>

<p>
Suppressing in this way has the advantage that we can easily search
for suppressions and revisit them.
</p>

<p>
You can get a list of pylint warnings by doing <code>pylint --list-msgs</code>.
To get more information on a particular message, use <code>pylint --help-msg=C6409</code>.
</p>


<p>
Prefer pylint: disable to the deprecated older form pylint: disable-msg.
</p>

<p>
Unused argument warnings can be suppressed by using '<code>_</code>' as the
identifier for the unused argument or prefixing the argument name with
'<code>unused_</code>'. In situations where changing the argument names is
infeasible, you can mention them at the beginning of the function. For
example:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">def</span> <span style="color: #87cefa;">foo</span>(a, unused_b, unused_c, d=<span style="color: #00ffff;">None</span>, e=<span style="color: #00ffff;">None</span>):
    <span style="color: #b0c4de;">_</span> = d, e
    <span style="color: #00ffff;">return</span> a
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Imports</h3>
<div class="outline-text-3" id="text-2-2">
<p class="info">
仅对包和模块使用导入
</p>

<p>
<b>Decision:</b>
Use import x for importing packages and modules. 
</p>

<p>
Use from x import y where x is the package prefix and y is the module
name with no prefix. 
</p>

<p>
Use from x import y as z if two modules named y are to be imported or
if y is an inconveniently long name.
</p>

<p>
For example the module sound.effects.echo may be imported as follows:
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">from</span> sound.effects <span style="color: #00ffff;">import</span> echo
...
echo.EchoFilter(input, output, <span style="color: #ffebcd; background-color: #2f4f4f;">delay</span>=0.7, <span style="color: #ffebcd; background-color: #2f4f4f;">atten</span>=4)
</pre>
</div>
<p>
Do not use relative names in imports. Even if the module is in the
same package, use the full package name. This helps prevent
unintentionally importing a package twice.
</p>
</div>
</div>
<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">Packages</h3>
<div class="outline-text-3" id="text-2-3">
<p class="info">
使用模块的全路径名来导入每个模块
</p>
<p>
<b>Decision:</b>
All new code should import each module by its full package name.
</p>

<p>
Imports should be as follows:
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">Reference in code with complete name.</span>
<span style="color: #00ffff;">import</span> sound.effects.echo

<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">Reference in code with just module name (preferred).</span>
<span style="color: #00ffff;">from</span> sound.effects <span style="color: #00ffff;">import</span> echo
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">Exceptions</h3>
<div class="outline-text-3" id="text-2-4">
<p class="info">
允许使用异常, 但必须小心
</p>

<p>
<b>Decision:</b>
Exceptions must follow certain conditions:
</p>

<ul class="org-ul">
<li>Raise exceptions like this: <code>raise MyException('Error message')</code> or
<code>raise MyException</code>. Do not use the two-argument form <code>(raise
  MyException, 'Error message')</code> or deprecated string-based exceptions
<code>(raise 'Error message')</code>.
</li>

<li>Modules or packages should define their own domain-specific base
exception class, which should inherit from the built-in Exception
class. The base exception for a module should be called Error.

<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">class</span> <span style="color: #98fb98;">Error</span>(<span style="color: #b0c4de;">Exception</span>):
    <span style="color: #00ffff;">pass</span>
</pre>
</div>
</li>
<li>Never use catch-all except: statements, or catch Exception or
StandardError, unless you are re-raising the exception or in the
outermost block in your thread (and printing an error message).
Python is very tolerant in this regard and except: will really catch
everything including misspelled names, sys.exit() calls, Ctrl+C
interrupts, unittest failures and all kinds of other exceptions that
you simply don't want to catch.
</li>

<li>Minimize the amount of code in a try/except block. The larger the
body of the try, the more likely that an exception will be raised by
a line of code that you didn't expect to raise an exception. In
those cases, the try/except block hides a real error.
</li>

<li>Use the finally clause to execute code whether or not an exception
is raised in the try block. This is often useful for cleanup, i.e.,
closing a file.
</li>

<li>When capturing an exception, use as rather than a comma. For example:
<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">try:</span>
    <span style="color: #00ffff;">raise</span> <span style="color: #b0c4de;">Error</span>
<span style="color: #00ffff;">except</span> <span style="color: #b0c4de;">Error</span> <span style="color: #00ffff;">as</span> error:
    <span style="color: #00ffff;">pass</span>
</pre>
</div>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5">Global variables</h3>
<div class="outline-text-3" id="text-2-5">
<p class="info">
避免全局变量
</p>

<p>
Decision:
</p>

<p>
Avoid global variables in favor of class variables. Some exceptions are:
</p>

<ul class="org-ul">
<li>Default options for scripts.
</li>
<li>Module-level constants. For example: <code>PI = 3.14159</code>. Constants
should be named using all caps with underscores; see Naming below.
</li>
<li>It is sometimes useful for globals to cache values needed or returned by functions.
</li>
<li>If needed, globals should be made internal to the module and
accessed through public module level functions; see Naming below.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-6" class="outline-3">
<h3 id="sec-2-6">Nested/Local/Inner Classes and Functions</h3>
<div class="outline-text-3" id="text-2-6">
<p class="info">
鼓励使用嵌套/本地/内部类或函数
</p>
</div>
</div>
<div id="outline-container-sec-2-7" class="outline-3">
<h3 id="sec-2-7">List Comprehensions</h3>
<div class="outline-text-3" id="text-2-7">
<p class="info">
可以在简单情况下使用
</p>
<p>
<b>Decision:</b>
Okay to use for simple cases. Each portion must fit on <b>one line</b>: mapping expression, for clause, filter expression. Multiple for clauses or filter expressions are not permitted. Use loops instead when things get more complicated.
</p>
<div class="org-src-container">

<pre class="src src-python">Yes:
  <span style="color: #ffebcd; background-color: #2f4f4f;">result</span> = []
  <span style="color: #00ffff;">for</span> x <span style="color: #00ffff;">in</span> <span style="color: #b0c4de;">range</span>(10):
      <span style="color: #00ffff;">for</span> y <span style="color: #00ffff;">in</span> <span style="color: #b0c4de;">range</span>(5):
          <span style="color: #00ffff;">if</span> x * y &gt; 10:
              result.append((x, y))

  <span style="color: #00ffff;">for</span> x <span style="color: #00ffff;">in</span> <span style="color: #b0c4de;">xrange</span>(5):
      <span style="color: #00ffff;">for</span> y <span style="color: #00ffff;">in</span> <span style="color: #b0c4de;">xrange</span>(5):
          <span style="color: #00ffff;">if</span> x != y:
              <span style="color: #00ffff;">for</span> z <span style="color: #00ffff;">in</span> <span style="color: #b0c4de;">xrange</span>(5):
                  <span style="color: #00ffff;">if</span> y != z:
                      <span style="color: #00ffff;">yield</span> (x, y, z)

  <span style="color: #00ffff;">return</span> ((x, complicated_transform(x))
          <span style="color: #00ffff;">for</span> x <span style="color: #00ffff;">in</span> long_generator_function(parameter)
          <span style="color: #00ffff;">if</span> x <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">not</span> <span style="color: #00ffff;">None</span>)

  <span style="color: #ffebcd; background-color: #2f4f4f;">squares</span> = [x * x <span style="color: #00ffff;">for</span> x <span style="color: #00ffff;">in</span> <span style="color: #b0c4de;">range</span>(10)]

  eat(jelly_bean <span style="color: #00ffff;">for</span> jelly_bean <span style="color: #00ffff;">in</span> jelly_beans
      <span style="color: #00ffff;">if</span> jelly_bean.color == <span style="color: #ffa07a;">'black'</span>)
No:
  <span style="color: #ffebcd; background-color: #2f4f4f;">result</span> = [(x, y) <span style="color: #00ffff;">for</span> x <span style="color: #00ffff;">in</span> <span style="color: #b0c4de;">range</span>(10) <span style="color: #00ffff;">for</span> y <span style="color: #00ffff;">in</span> <span style="color: #b0c4de;">range</span>(5) <span style="color: #00ffff;">if</span> x * y &gt; 10]

  <span style="color: #00ffff;">return</span> ((x, y, z)
          <span style="color: #00ffff;">for</span> x <span style="color: #00ffff;">in</span> <span style="color: #b0c4de;">xrange</span>(5)
          <span style="color: #00ffff;">for</span> y <span style="color: #00ffff;">in</span> <span style="color: #b0c4de;">xrange</span>(5)
          <span style="color: #00ffff;">if</span> x != y
          <span style="color: #00ffff;">for</span> z <span style="color: #00ffff;">in</span> <span style="color: #b0c4de;">xrange</span>(5)
          <span style="color: #00ffff;">if</span> y != z)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-8" class="outline-3">
<h3 id="sec-2-8">Default Iterators and Operators</h3>
<div class="outline-text-3" id="text-2-8">
<p class="info">
如果类型支持, 就使用默认迭代器和操作符. 比如列表, 字典及文件等.
</p>
<p>
Decision:
Use default iterators and operators for types that support them, like
lists, dictionaries, and files. The built-in types define iterator
methods, too. Prefer these methods to methods that return lists,
except that you should not mutate a container while iterating over it.
</p>

<div class="org-src-container">

<pre class="src src-python">Yes:  <span style="color: #00ffff;">for</span> key <span style="color: #00ffff;">in</span> adict: ...
      <span style="color: #00ffff;">if</span> key <span style="color: #00ffff;">not</span> <span style="color: #00ffff;">in</span> adict: ...
      <span style="color: #00ffff;">if</span> obj <span style="color: #00ffff;">in</span> alist: ...
      <span style="color: #00ffff;">for</span> line <span style="color: #00ffff;">in</span> afile: ...
      <span style="color: #00ffff;">for</span> k, v <span style="color: #00ffff;">in</span> dict.iteritems(): ...
No:   <span style="color: #00ffff;">for</span> key <span style="color: #00ffff;">in</span> adict.keys(): ...
      <span style="color: #00ffff;">if</span> <span style="color: #00ffff;">not</span> adict.has_key(key): ...
      <span style="color: #00ffff;">for</span> line <span style="color: #00ffff;">in</span> afile.readlines(): ...
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-9" class="outline-3">
<h3 id="sec-2-9">Generators</h3>
<div class="outline-text-3" id="text-2-9">
<p class="info">
按需使用生成器.
</p>
<p>
Decision:
</p>

<p>
Fine. Use "Yields:" rather than "Returns:" in the doc string for generator functions.
</p>
</div>
</div>
<div id="outline-container-sec-2-10" class="outline-3">
<h3 id="sec-2-10">Lambda Functions</h3>
<div class="outline-text-3" id="text-2-10">
<p class="info">
适用于单行函数
</p>
<p>
Decision:
</p>

<p>
Okay to use them for one-liners. If the code inside the lambda function is any longer than 60–80 chars, it's probably better to define it as a regular (nested) function.
</p>

<p>
For common operations like multiplication, use the functions from the
operator module instead of lambda functions. For example, prefer
<code>operator.mul</code> to <code>lambda x, y: x * y</code>.
</p>
</div>
</div>
<div id="outline-container-sec-2-11" class="outline-3">
<h3 id="sec-2-11">Conditional Expressions</h3>
<div class="outline-text-3" id="text-2-11">
<p class="info">
适用于单行.
</p>
<p>
Conditional expressions are mechanisms that provide a shorter syntax
for if statements. For example: <code>x = 1 if cond else 2</code>
</p>
</div>
</div>
<div id="outline-container-sec-2-12" class="outline-3">
<h3 id="sec-2-12">Default Argument Values</h3>
<div class="outline-text-3" id="text-2-12">
<p class="info">
适用于大部分情况.
</p>
<p>
Decision:
</p>

<p>
Okay to use with the following caveat:
</p>

<p>
Do not use mutable objects as default values in the function or method definition.
</p>
<div class="org-src-container">

<pre class="src src-python">Yes: <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">foo</span>(a, b=<span style="color: #00ffff;">None</span>):
         <span style="color: #00ffff;">if</span> b <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">None</span>:
             b = []
No:  <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">foo</span>(a, b=[]):
         ...
No:  <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">foo</span>(a, b=time.time()):  <span style="color: #ff7f24;"># The time the module was loaded???</span>
         ...
No:  <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">foo</span>(a, b=FLAGS.my_thing):  <span style="color: #ff7f24;"># sys.argv has not yet been parsed...</span>
         ...
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-13" class="outline-3">
<h3 id="sec-2-13">Properties</h3>
<div class="outline-text-3" id="text-2-13">
<p class="info">
访问和设置数据成员时, 你通常会使用简单, 轻量级的访问和设置函数. 建议用属性（properties）来代替它们.
</p>
<p>
Use properties in new code to access or set data where you would
normally have used simple, lightweight accessor or setter methods.
Read-only properties should be created with the <code>@property</code> decorator.
</p>

<p>
Inheritance with properties can be non-obvious if the property itself
is not overridden. Thus one must make sure that accessor methods are
called indirectly to ensure methods overridden in subclasses are
called by the property (using the Template Method DP).
</p>

<div class="org-src-container">

<pre class="src src-python">Yes: <span style="color: #00ffff;">import</span> math

     <span style="color: #00ffff;">class</span> <span style="color: #98fb98;">Square</span>(object):
         <span style="color: #ffa07a;">"""A square with two properties: a writable area and a read-only perimeter.</span>

<span style="color: #ffa07a;">         To use:</span>
<span style="color: #ffa07a;">         &gt;&gt;&gt; sq = Square(3)</span>
<span style="color: #ffa07a;">         &gt;&gt;&gt; sq.area</span>
<span style="color: #ffa07a;">         9</span>
<span style="color: #ffa07a;">         &gt;&gt;&gt; sq.perimeter</span>
<span style="color: #ffa07a;">         12</span>
<span style="color: #ffa07a;">         &gt;&gt;&gt; sq.area = 16</span>
<span style="color: #ffa07a;">         &gt;&gt;&gt; sq.side</span>
<span style="color: #ffa07a;">         4</span>
<span style="color: #ffa07a;">         &gt;&gt;&gt; sq.perimeter</span>
<span style="color: #ffa07a;">         16</span>
<span style="color: #ffa07a;">         """</span>

         <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">__init__</span>(<span style="color: #00ffff;">self</span>, side):
             <span style="color: #00ffff;">self</span>.side = side

         <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">__get_area</span>(<span style="color: #00ffff;">self</span>):
             <span style="color: #ffa07a;">"""Calculates the 'area' property."""</span>
             <span style="color: #00ffff;">return</span> <span style="color: #00ffff;">self</span>.side ** 2

         <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">___get_area</span>(<span style="color: #00ffff;">self</span>):
             <span style="color: #ffa07a;">"""Indirect accessor for 'area' property."""</span>
             <span style="color: #00ffff;">return</span> <span style="color: #00ffff;">self</span>.__get_area()

         <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">__set_area</span>(<span style="color: #00ffff;">self</span>, area):
             <span style="color: #ffa07a;">"""Sets the 'area' property."""</span>
             <span style="color: #00ffff;">self</span>.side = math.sqrt(area)

         <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">___set_area</span>(<span style="color: #00ffff;">self</span>, area):
             <span style="color: #ffa07a;">"""Indirect setter for 'area' property."""</span>
             <span style="color: #00ffff;">self</span>.__set_area(area)

         <span style="color: #ffebcd; background-color: #2f4f4f;">area</span> = <span style="color: #b0c4de;">property</span>(___get_area, ___set_area,
                         <span style="color: #ffebcd; background-color: #2f4f4f;">doc</span>=<span style="color: #ffa07a;">"""Gets or sets the area of the square."""</span>)

         <span style="color: #00ffff;">@property</span>
         <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">perimeter</span>(<span style="color: #00ffff;">self</span>):
             <span style="color: #00ffff;">return</span> <span style="color: #00ffff;">self</span>.side * 4
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-14" class="outline-3">
<h3 id="sec-2-14">True/False evaluations</h3>
<div class="outline-text-3" id="text-2-14">
<p class="info">
尽可能使用隐式false
</p>
<p>
Use the "implicit" false if at all possible, e.g., <code>if foo:</code> rather than
<code>if foo != []:</code>. There are a few caveats that you should keep in mind
though: 
</p>

<ul class="org-ul">
<li>Never use <code>= or !</code> to compare singletons like None. Use is or is not.
</li>
<li>Beware of writing if x: when you really mean if x is not None:—e.g.,
when testing whether a variable or argument that defaults to None
was set to some other value. The other value might be a value that's
false in a boolean context!
</li>
<li>Never compare a boolean variable to False using ==. Use if not x:
instead. If you need to distinguish False from None then chain the
expressions, such as if not x and x is not None:.
</li>
<li>For sequences (strings, lists, tuples), use the fact that empty
sequences are false, so if not seq: or if seq: is preferable to if
len(seq): or if not len(seq):.
</li>
<li>When handling integers, implicit false may involve more risk than
benefit (i.e., accidentally handling None as 0). You may compare a
value which is known to be an integer (and is not the result of
len()) against the integer 0.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-python">Yes: <span style="color: #00ffff;">if</span> <span style="color: #00ffff;">not</span> users:
         <span style="color: #b0c4de;">print</span> <span style="color: #ffa07a;">'no users'</span>

     <span style="color: #00ffff;">if</span> foo == 0:
         <span style="color: #00ffff;">self</span>.handle_zero()

     <span style="color: #00ffff;">if</span> i % 10 == 0:
         <span style="color: #00ffff;">self</span>.handle_multiple_of_ten()
No:  <span style="color: #00ffff;">if</span> <span style="color: #b0c4de;">len</span>(users) == 0:
         <span style="color: #b0c4de;">print</span> <span style="color: #ffa07a;">'no users'</span>

     <span style="color: #00ffff;">if</span> foo <span style="color: #00ffff;">is</span> <span style="color: #00ffff;">not</span> <span style="color: #00ffff;">None</span> <span style="color: #00ffff;">and</span> <span style="color: #00ffff;">not</span> foo:
         <span style="color: #00ffff;">self</span>.handle_zero()

     <span style="color: #00ffff;">if</span> <span style="color: #00ffff;">not</span> i % 10:
         <span style="color: #00ffff;">self</span>.handle_multiple_of_ten()
</pre>
</div>
<ul class="org-ul">
<li>Note that '0' (i.e., 0 as string) evaluates to true.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-15" class="outline-3">
<h3 id="sec-2-15">Deprecated Language Features</h3>
<div class="outline-text-3" id="text-2-15">
<p class="info">
尽可能使用字符串方法取代字符串模块. 使用函数调用语法取代apply(). 
使用列表推导, for循环取代filter()和map()当函数参数是个内联的lamdba.
使用for取代reduce().
</p>
<p>
We do not use any Python version which does not support these
features, so there is no reason not to use the new styles.
</p>

<div class="org-src-container">

<pre class="src src-python">Yes: <span style="color: #ffebcd; background-color: #2f4f4f;">words</span> = foo.split(<span style="color: #ffa07a;">':'</span>)

     [x[1] <span style="color: #00ffff;">for</span> x <span style="color: #00ffff;">in</span> my_list <span style="color: #00ffff;">if</span> x[2] == 5]

     <span style="color: #b0c4de;">map</span>(math.sqrt, data)    <span style="color: #ff7f24;"># Ok. No inlined lambda expression.</span>

     fn(*args, **kwargs)
No:  <span style="color: #ffebcd; background-color: #2f4f4f;">words</span> = string.split(foo, <span style="color: #ffa07a;">':'</span>)

     <span style="color: #b0c4de;">map</span>(<span style="color: #00ffff;">lambda</span> x: x[1], <span style="color: #b0c4de;">filter</span>(<span style="color: #00ffff;">lambda</span> x: x[2] == 5, my_list))

     <span style="color: #b0c4de;">apply</span>(fn, args, kwargs)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-16" class="outline-3">
<h3 id="sec-2-16">Lexical Scoping</h3>
<div class="outline-text-3" id="text-2-16">
<p class="info">
可以使用
</p>
</div>
</div>
<div id="outline-container-sec-2-17" class="outline-3">
<h3 id="sec-2-17">Function and Method Decorators</h3>
<div class="outline-text-3" id="text-2-17">
<p class="info">
如果好处很显然, 就明智的使用装饰器
</p>
<p>
Use decorators judiciously when there is a clear advantage. Decorators
should follow the same import and naming guidelines as functions.
Decorator pydoc should clearly state that the function is a decorator.
Write unit tests for decorators.
</p>

<p>
Avoid external dependencies in the decorator itself (e.g. don't rely
on files, sockets, database connections, etc.), since they might not
be available when the decorator runs (at import time, perhaps from
pydoc or other tools). A decorator that is called with valid
parameters should (as much as possible) be guaranteed to succeed in
all cases.
</p>

<p>
Decorators are a special case of "top level code" - see main for more
discussion.
</p>
</div>
</div>
<div id="outline-container-sec-2-18" class="outline-3">
<h3 id="sec-2-18">Threading</h3>
<div class="outline-text-3" id="text-2-18">
<p class="info">
不要依赖内建类型的原子性.
</p>
<p>
While Python's built-in data types such as dictionaries appear to have atomic operations, there are corner cases where they aren't atomic (e.g. if <span class="underline"><span class="underline">hash</span></span> or <span class="underline"><span class="underline">eq</span></span> are implemented as Python methods) and their atomicity should not be relied upon. Neither should you rely on atomic variable assignment (since this in turn depends on dictionaries).
</p>

<p>
Use the Queue module's Queue data type as the preferred way to
communicate data between threads. Otherwise, use the threading module
and its locking primitives. Learn about the proper use of condition
variables so you can use threading.Condition instead of using
lower-level locks.
</p>
</div>
</div>
<div id="outline-container-sec-2-19" class="outline-3">
<h3 id="sec-2-19">Power Features</h3>
<div class="outline-text-3" id="text-2-19">
<p class="info">
避免使用这些特性
</p>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Python Style Rules</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Semicolons</h3>
<div class="outline-text-3" id="text-3-1">
<p class="info">
不要在行尾加分号, 也不要用分号将两条命令放在同一行.
</p>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Line length</h3>
<div class="outline-text-3" id="text-3-2">
<p class="info">
每行不超过80个字符
</p>
<p>
Exceptions:
</p>

<ul class="org-ul">
<li>Long import statements.
</li>
<li>URLs in comments.
</li>
</ul>

<p>
Do not use backslash line continuation.
</p>

<p>
Make use of Python's <a href="http://docs.python.org/2/reference/lexical_analysis.html#implicit-line-joining">implicit line joining inside parentheses</a>,
brackets and braces. If necessary, you can add an extra pair of
parentheses around an expression.
</p>

<div class="org-src-container">

<pre class="src src-python">Yes: foo_bar(<span style="color: #00ffff;">self</span>, width, height, <span style="color: #ffebcd; background-color: #2f4f4f;">color</span>=<span style="color: #ffa07a;">'black'</span>, <span style="color: #ffebcd; background-color: #2f4f4f;">design</span>=<span style="color: #00ffff;">None</span>, x=<span style="color: #ffa07a;">'foo'</span>,
             <span style="color: #ffebcd; background-color: #2f4f4f;">emphasis</span>=<span style="color: #00ffff;">None</span>, <span style="color: #ffebcd; background-color: #2f4f4f;">highlight</span>=0)

     <span style="color: #00ffff;">if</span> (width == 0 <span style="color: #00ffff;">and</span> height == 0 <span style="color: #00ffff;">and</span>
         color == <span style="color: #ffa07a;">'red'</span> <span style="color: #00ffff;">and</span> emphasis == <span style="color: #ffa07a;">'strong'</span>):
</pre>
</div>
<p>
When a literal string won't fit on a single line, use parentheses for implicit line joining.
</p>
<div class="org-src-container">

<pre class="src src-python">x = (<span style="color: #ffa07a;">'This will build a very long long '</span>
     <span style="color: #ffa07a;">'long long long long long long string'</span>)
</pre>
</div>
<p>
Within comments, put long URLs on their own line if necessary.
</p>
<div class="org-src-container">

<pre class="src src-python">Yes:  <span style="color: #ff7f24;"># See details at</span>
      <span style="color: #ff7f24;"># http://www.example.com/us/developer/documentation/api/content/v2.0/csv_file_name_extension_full_specification.html</span>
No:  <span style="color: #ff7f24;"># See details at</span>
     <span style="color: #ff7f24;"># http://www.example.com/us/developer/documentation/api/content/\</span>
     <span style="color: #ff7f24;"># v2.0/csv_file_name_extension_full_specification.html</span>
</pre>
</div>
<p>
Make note of the <b>indentation</b> of the elements in the line continuation
examples above; see the indentation section for explanation.
</p>
</div>
</div>
<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">Parentheses</h3>
<div class="outline-text-3" id="text-3-3">
<p class="info">
保守的使用括号
</p>
<p>
Do not use them in return statements or conditional statements unless
using parentheses for implied line continuation. (See above.) It is
however fine to use parentheses around tuples.
</p>

<div class="org-src-container">

<pre class="src src-python">Yes: <span style="color: #00ffff;">if</span> foo:
         bar()
     <span style="color: #00ffff;">while</span> x:
         x = bar()
     <span style="color: #00ffff;">if</span> x <span style="color: #00ffff;">and</span> y:
         bar()
     <span style="color: #00ffff;">if</span> <span style="color: #00ffff;">not</span> x:
         bar()
     <span style="color: #00ffff;">return</span> foo
     <span style="color: #00ffff;">for</span> (x, y) <span style="color: #00ffff;">in</span> dict.items(): ...
No:  <span style="color: #00ffff;">if</span> (x):
         bar()
     <span style="color: #00ffff;">if</span> <span style="color: #00ffff;">not</span>(x):
         bar()
     <span style="color: #00ffff;">return</span> (foo)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4">Indentation</h3>
<div class="outline-text-3" id="text-3-4">
<p class="info">
用4个空格来缩进代码
</p>

<p>
Never use tabs or mix tabs and spaces. In cases of implied line
continuation, you should align wrapped elements either vertically, as
per the examples in the <b>line length</b> section; or using a hanging indent
of 4 spaces, in which case there should be no argument on the first
line.
</p>

<div class="org-src-container">

<pre class="src src-python">Yes:   <span style="color: #ff7f24;"># Aligned with opening delimiter</span>
       <span style="color: #ffebcd; background-color: #2f4f4f;">foo</span> = long_function_name(var_one, var_two,
                                var_three, var_four)

       <span style="color: #ff7f24;"># Aligned with opening delimiter in a dictionary</span>
       <span style="color: #ffebcd; background-color: #2f4f4f;">foo</span> = {
           long_dictionary_key: value1 +
                                value2,
           ...
       }

       <span style="color: #ff7f24;"># 4-space hanging indent; nothing on first line</span>
       <span style="color: #ffebcd; background-color: #2f4f4f;">foo</span> = long_function_name(
           var_one, var_two, var_three,
           var_four)

       <span style="color: #ff7f24;"># 4-space hanging indent in a dictionary</span>
       <span style="color: #ffebcd; background-color: #2f4f4f;">foo</span> = {
           long_dictionary_key:
               long_dictionary_value,
           ...
       }
No:    <span style="color: #ff7f24;"># Stuff on first line forbidden</span>
       <span style="color: #ffebcd; background-color: #2f4f4f;">foo</span> = long_function_name(var_one, var_two,
           var_three, var_four)

       <span style="color: #ff7f24;"># 2-space hanging indent forbidden</span>
       <span style="color: #ffebcd; background-color: #2f4f4f;">foo</span> = long_function_name(
         var_one, var_two, var_three,
         var_four)

       <span style="color: #ff7f24;"># No hanging indent in a dictionary</span>
       <span style="color: #ffebcd; background-color: #2f4f4f;">foo</span> = {
       long_dictionary_key:
       long_dictionary_value,
               ...
       }
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5">Blank Lines</h3>
<div class="outline-text-3" id="text-3-5">
<p class="info">
顶级定义之间空两行, 方法定义之间空一行
</p>
<p>
One blank line between method definitions and between the class line
and the first method. Use single blank lines as you judge appropriate
within functions or methods.
</p>
</div>
</div>

<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6">Whitespace</h3>
<div class="outline-text-3" id="text-3-6">
<p class="info">
按照标准的排版规范来使用标点两边的空格
</p>

<p>
No whitespace inside parentheses, brackets or braces.
</p>
<div class="org-src-container">

<pre class="src src-python">Yes: spam(ham[1], {eggs: 2}, [])
No:  spam( ham[ 1 ], { eggs: 2 }, [ ] )
</pre>
</div>
<p>
No whitespace before a comma, semicolon, or colon. Do use whitespace
after a comma, semicolon, or colon except at the end of the line.
</p>

<div class="org-src-container">

<pre class="src src-python">Yes: <span style="color: #00ffff;">if</span> x == 4:
         <span style="color: #b0c4de;">print</span> x, y
     x, y = y, x
No:  <span style="color: #00ffff;">if</span> x == 4 :
         <span style="color: #b0c4de;">print</span> x , y
     x , y = y , x
</pre>
</div>
<p>
No whitespace before the open paren/bracket that starts an argument
list, indexing or slicing.
</p>

<div class="org-src-container">

<pre class="src src-python">Yes: spam(1)
No:  spam (1)
Yes: dict[<span style="color: #ffa07a;">'key'</span>] = list[index]
No:  <span style="color: #b0c4de;">dict</span> [<span style="color: #ffa07a;">'key'</span>] = <span style="color: #b0c4de;">list</span> [index]
</pre>
</div>
<p>
Surround binary operators with a single space on either side for
assignment <code>(=)</code>, comparisons (<code>==, &lt;, &gt;, !=, &lt;&gt;, &lt;=, &gt;=</code>, in, not in, is,
is not), and Booleans (and, or, not). Use your better judgment for the
insertion of spaces around arithmetic operators but always be
consistent about whitespace on either side of a binary operator.
</p>

<div class="org-src-container">

<pre class="src src-python">Yes: x == 1
No:  x&lt;1
</pre>
</div>
<p>
Don't use spaces around the '=' sign when used to indicate a keyword
argument or a default parameter value.
</p>

<div class="org-src-container">

<pre class="src src-python">Yes: <span style="color: #00ffff;">def</span> <span style="color: #b0c4de;">complex</span>(real, <span style="color: #ffebcd; background-color: #2f4f4f;">imag</span>=0.0): <span style="color: #00ffff;">return</span> magic(r=real, i=imag)
No:  <span style="color: #00ffff;">def</span> <span style="color: #b0c4de;">complex</span>(real, <span style="color: #ffebcd; background-color: #2f4f4f;">imag</span> = 0.0): <span style="color: #00ffff;">return</span> magic(r = real, i = imag)
</pre>
</div>
<p>
Don't use spaces to vertically align tokens on consecutive lines,
since it becomes a maintenance burden (applies to :, #, =, etc.):
</p>

<div class="org-src-container">

<pre class="src src-python">Yes:
  <span style="color: #ffebcd; background-color: #2f4f4f;">foo</span> = 1000  <span style="color: #ff7f24;"># comment</span>
  <span style="color: #ffebcd; background-color: #2f4f4f;">long_name</span> = 2  <span style="color: #ff7f24;"># comment that should not be aligned</span>

  <span style="color: #ffebcd; background-color: #2f4f4f;">dictionary</span> = {
      <span style="color: #ffa07a;">'foo'</span>: 1,
      <span style="color: #ffa07a;">'long_name'</span>: 2,
  }
No:
  <span style="color: #ffebcd; background-color: #2f4f4f;">foo</span>       = 1000  <span style="color: #ff7f24;"># comment</span>
  <span style="color: #ffebcd; background-color: #2f4f4f;">long_name</span> = 2     <span style="color: #ff7f24;"># comment that should not be aligned</span>

  <span style="color: #ffebcd; background-color: #2f4f4f;">dictionary</span> = {
      <span style="color: #ffa07a;">'foo'</span>      : 1,
      <span style="color: #ffa07a;">'long_name'</span>: 2,
  }
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-7" class="outline-3">
<h3 id="sec-3-7">Shebang Line</h3>
<div class="outline-text-3" id="text-3-7">
<p class="info">
大部分.py文件不要以#!行开头。以#!/usr/bin/env python<version>开头
</p>

<p>
This line is used by the kernel to find the Python interpreter, but is
ignored by Python when importing modules. It is only necessary on a
file that will be executed directly.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">!/usr/bin/env python2.4</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-8" class="outline-3">
<h3 id="sec-3-8">Comments</h3>
<div class="outline-text-3" id="text-3-8">
<p class="info">
确保对模块, 函数, 方法和行内注释使用正确的风格
</p>
</div>
<ul class="org-ul"><li><a id="sec-3-8-1" name="sec-3-8-1"></a>Doc Strings<br  /><div class="outline-text-4" id="text-3-8-1">
<p>
Python has a unique commenting style using doc strings. A doc string
is a string that is the first statement in a package, module, class or
function. These strings can be extracted automatically through the
<code>__doc__</code> member of the object and are used by pydoc. (Try running pydoc
on your module to see how it looks.) We always use the three
double-quote """ format for doc strings (per PEP 257). A doc string
should be organized as a summary line (one physical line) terminated
by a period, question mark, or exclamation point, followed by a blank
line, followed by the rest of the doc string starting at the same
cursor position as the first quote of the first line. There are more
formatting guidelines for doc strings below.
</p>
</div>
</li>
<li><a id="sec-3-8-2" name="sec-3-8-2"></a>Modules<br  /><div class="outline-text-4" id="text-3-8-2">
<ul class="org-ul">
<li>Every file should contain license boilerplate.(Copyright 2008 Google Inc)
</li>
<li>Choose the appropriate boilerplate for the license used by the
project (for example, Apache 2.0, BSD, LGPL, GPL)
</li>
</ul>
</div>
</li>
<li><a id="sec-3-8-3" name="sec-3-8-3"></a>Functions and Methods<br  /><div class="outline-text-4" id="text-3-8-3">
<p>
As used in this section "function" applies to methods, function, and
generators.
</p>

<p>
A function must have a docstring, unless it meets all of the following
criteria:
</p>
<ul class="org-ul">
<li>not externally visible
</li>
<li>very short
</li>
<li>obvious
</li>

<li>A docstring should give enough information to write a call to the
function without reading the function's code. 
</li>
<li>A docstring should describe the function's calling syntax and its
semantics, not its implementation. 
</li>
<li>For tricky code, comments alongside the code are more appropriate
than using docstrings.
</li>
</ul>

<p>
Certain aspects of a function should be documented in special
sections, listed below. Each section begins with a heading line, which
ends with a colon. Sections should be indented two spaces, except for
the heading.
</p>

<p>
Args:
    List each parameter by name. A description should follow the name,
    and be separated by a colon and a space. If the description is too
    long to fit on a single 80-character line, use a hanging indent of
    2 or 4 spaces (be consistent with the rest of the file).
</p>

<p>
The description should mention required type(s) and the meaning of
the argument.
</p>

<p>
 If a function accepts *foo (variable length argument lists) and/or
**bar (arbitrary keyword arguments), they should be listed as *foo
and **bar.
</p>


<p>
Returns: (or Yields: for generators)
    Describe the type and semantics of the return value. If the
    function only returns None, this section is not required.
</p>

<p>
Raises:
    List all exceptions that are relevant to the interface.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">def</span> <span style="color: #87cefa;">fetch_bigtable_rows</span>(big_table, keys, <span style="color: #ffebcd; background-color: #2f4f4f;">other_silly_variable</span>=<span style="color: #00ffff;">None</span>):
    <span style="color: #ffa07a;">"""Fetches rows from a Bigtable.</span>

<span style="color: #ffa07a;">    Retrieves rows pertaining to the given keys from the Table instance</span>
<span style="color: #ffa07a;">    represented by big_table.  Silly things may happen if</span>
<span style="color: #ffa07a;">    other_silly_variable is not None.</span>

<span style="color: #ffa07a;">    Args:</span>
<span style="color: #ffa07a;">        big_table: An open Bigtable Table instance.</span>
<span style="color: #ffa07a;">        keys: A sequence of strings representing the key of each table row</span>
<span style="color: #ffa07a;">            to fetch.</span>
<span style="color: #ffa07a;">        other_silly_variable: Another optional variable, that has a much</span>
<span style="color: #ffa07a;">            longer name than the other args, and which does nothing.</span>

<span style="color: #ffa07a;">    Returns:</span>
<span style="color: #ffa07a;">        A dict mapping keys to the corresponding table row data</span>
<span style="color: #ffa07a;">        fetched. Each row is represented as a tuple of strings. For</span>
<span style="color: #ffa07a;">        example:</span>

<span style="color: #ffa07a;">        {'Serak': ('Rigel VII', 'Preparer'),</span>
<span style="color: #ffa07a;">         'Zim': ('Irk', 'Invader'),</span>
<span style="color: #ffa07a;">         'Lrrr': ('Omicron Persei 8', 'Emperor')}</span>

<span style="color: #ffa07a;">        If a key from the keys argument is missing from the dictionary,</span>
<span style="color: #ffa07a;">        then that row was not found in the table.</span>

<span style="color: #ffa07a;">    Raises:</span>
<span style="color: #ffa07a;">        IOError: An error occurred accessing the bigtable.Table object.</span>
<span style="color: #ffa07a;">    """</span>
    <span style="color: #00ffff;">pass</span>
</pre>
</div>
</div>
</li>
<li><a id="sec-3-8-4" name="sec-3-8-4"></a>Classes<br  /><div class="outline-text-4" id="text-3-8-4">
<p>
Classes should have a doc string below the class definition describing
the class. If your class has public attributes, they should be
documented here in an Attributes section and follow the same
formatting as a function's Args section.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">class</span> <span style="color: #98fb98;">SampleClass</span>(object):
    <span style="color: #ffa07a;">"""Summary of class here.</span>

<span style="color: #ffa07a;">    Longer class information....</span>
<span style="color: #ffa07a;">    Longer class information....</span>

<span style="color: #ffa07a;">    Attributes:</span>
<span style="color: #ffa07a;">        likes_spam: A boolean indicating if we like SPAM or not.</span>
<span style="color: #ffa07a;">        eggs: An integer count of the eggs we have laid.</span>
<span style="color: #ffa07a;">    """</span>

    <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">__init__</span>(<span style="color: #00ffff;">self</span>, <span style="color: #ffebcd; background-color: #2f4f4f;">likes_spam</span>=<span style="color: #00ffff;">False</span>):
        <span style="color: #ffa07a;">"""Inits SampleClass with blah."""</span>
        <span style="color: #00ffff;">self</span>.likes_spam = likes_spam
        <span style="color: #00ffff;">self</span>.eggs = 0

    <span style="color: #00ffff;">def</span> <span style="color: #87cefa;">public_method</span>(<span style="color: #00ffff;">self</span>):
        <span style="color: #ffa07a;">"""Performs operation blah."""</span>
</pre>
</div>
</div>
</li>
<li><a id="sec-3-8-5" name="sec-3-8-5"></a>Block and Inline Comments<br  /><div class="outline-text-4" id="text-3-8-5">
<p>
The final place to have comments is in tricky parts of the code. If
you're going to have to explain it at the next code review, you should
comment it now. Complicated operations get a few lines of comments
before the operations commence. Non-obvious ones get comments at the
end of the line.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">We use a weighted dictionary search to find out where i is in</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">the array.  We extrapolate position based on the largest num</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">in the array and the array size and then do binary search to</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">get the exact number.</span>

<span style="color: #00ffff;">if</span> i &amp; (i-1) == 0:        <span style="color: #ff7f24;"># true iff i is a power of 2</span>
</pre>
</div>

<p>
To improve legibility, these comments should be at least 2 spaces away from the code.
</p>
</div>
</li></ul>
</div>

<div id="outline-container-sec-3-9" class="outline-3">
<h3 id="sec-3-9">Classes</h3>
<div class="outline-text-3" id="text-3-9">
<p class="info">
如果一个类不继承自其它类, 就显式的从object继承. 嵌套类也一样.
</p>
<div class="org-src-container">

<pre class="src src-python">Yes: <span style="color: #00ffff;">class</span> <span style="color: #98fb98;">SampleClass</span>(object):
         <span style="color: #00ffff;">pass</span>


     <span style="color: #00ffff;">class</span> <span style="color: #98fb98;">OuterClass</span>(object):

         <span style="color: #00ffff;">class</span> <span style="color: #98fb98;">InnerClass</span>(object):
             <span style="color: #00ffff;">pass</span>


     <span style="color: #00ffff;">class</span> <span style="color: #98fb98;">ChildClass</span>(ParentClass):
         <span style="color: #ffa07a;">"""Explicitly inherits from another class already."""</span>

No: <span style="color: #00ffff;">class</span> <span style="color: #98fb98;">SampleClass</span>:
        <span style="color: #00ffff;">pass</span>


    <span style="color: #00ffff;">class</span> <span style="color: #98fb98;">OuterClass</span>:

        <span style="color: #00ffff;">class</span> <span style="color: #98fb98;">InnerClass</span>:
            <span style="color: #00ffff;">pass</span>
</pre>
</div>
<p>
Inheriting from <code>object</code> is needed to make properties work properly, and
it will protect your code from one particular potential
incompatibility with Python 3000. It also defines special methods that
implement the default semantics of objects including
<code>__new__,__init__, __delattr__, __getattribute__, __setattr__, __hash__,
__repr__, and __str__</code>.
</p>
</div>
</div>
<div id="outline-container-sec-3-10" class="outline-3">
<h3 id="sec-3-10">Strings</h3>
<div class="outline-text-3" id="text-3-10">
<p class="info">
用format方法或%操作符格式化字符串, 即使参数都是字符串.
然而你也需要在+和%(或%)之间好好判定.
</p>
<div class="org-src-container">

<pre class="src src-python">Yes: x = a + b
     x = <span style="color: #ffa07a;">'%s, %s!'</span> % (imperative, expletive)
     x = <span style="color: #ffa07a;">'{}, {}!'</span>.format(imperative, expletive)
     x = <span style="color: #ffa07a;">'name: %s; score: %d'</span> % (name, n)
     x = <span style="color: #ffa07a;">'name: {}; score: {}'</span>.format(name, n)
No: x = <span style="color: #ffa07a;">'%s%s'</span> % (a, b)  <span style="color: #ff7f24;"># use + in this case</span>
    x = <span style="color: #ffa07a;">'{}{}'</span>.format(a, b)  <span style="color: #ff7f24;"># use + in this case</span>
    x = imperative + <span style="color: #ffa07a;">', '</span> + expletive + <span style="color: #ffa07a;">'!'</span>
    x = <span style="color: #ffa07a;">'name: '</span> + name + <span style="color: #ffa07a;">'; score: '</span> + <span style="color: #b0c4de;">str</span>(n)
</pre>
</div>

<p>
Avoid using the + and += operators to accumulate a string within a
loop. Since strings are immutable, this creates unnecessary temporary
objects and results in quadratic rather than linear running time.
Instead, add each substring to a list and ''.join the list after the
loop terminates (or, write each substring to a io.BytesIO buffer).
</p>

<div class="org-src-container">

<pre class="src src-python">Yes: <span style="color: #ffebcd; background-color: #2f4f4f;">items</span> = [<span style="color: #ffa07a;">'&lt;table&gt;'</span>]
     <span style="color: #00ffff;">for</span> last_name, first_name <span style="color: #00ffff;">in</span> employee_list:
         items.append(<span style="color: #ffa07a;">'&lt;tr&gt;&lt;td&gt;%s, %s&lt;/td&gt;&lt;/tr&gt;'</span> % (last_name, first_name))
     items.append(<span style="color: #ffa07a;">'&lt;/table&gt;'</span>)
     <span style="color: #ffebcd; background-color: #2f4f4f;">employee_table</span> = <span style="color: #ffa07a;">''</span>.join(items)
No: <span style="color: #ffebcd; background-color: #2f4f4f;">employee_table</span> = <span style="color: #ffa07a;">'&lt;table&gt;'</span>
    <span style="color: #00ffff;">for</span> last_name, first_name <span style="color: #00ffff;">in</span> employee_list:
        <span style="color: #ffebcd; background-color: #2f4f4f;">employee_table</span> += <span style="color: #ffa07a;">'&lt;tr&gt;&lt;td&gt;%s, %s&lt;/td&gt;&lt;/tr&gt;'</span> % (last_name, first_name)
    <span style="color: #ffebcd; background-color: #2f4f4f;">employee_table</span> += <span style="color: #ffa07a;">'&lt;/table&gt;'</span>
</pre>
</div>

<p>
Be consistent with your choice of string quote character within a
file. Pick ' or " and stick with it. It is okay to use the other quote
character on a string to avoid the need to \ escape within the string.
GPyLint enforces this.
</p>

<div class="org-src-container">

<pre class="src src-python">Yes:
  Python(<span style="color: #ffa07a;">'Why are you hiding your eyes?'</span>)
  Gollum(<span style="color: #ffa07a;">"I'm scared of lint errors."</span>)
  Narrator(<span style="color: #ffa07a;">'"Good!" thought a happy Python reviewer.'</span>)
No:
  Python(<span style="color: #ffa07a;">"Why are you hiding your eyes?"</span>)
  Gollum(<span style="color: #ffa07a;">'The lint. It burns. It burns us.'</span>)
  Gollum(<span style="color: #ffa07a;">"Always the great lint. Watching. Watching."</span>)
</pre>
</div>

<p>
Prefer """ for multi-line strings rather than '''. Projects may choose
to use ''' for all non-docstring multi-line strings if and only if
they also use ' for regular strings. Doc strings must use """
regardless. Note that it is often cleaner to use implicit line joining
since multi-line strings do not flow with the indentation of the rest
of the program:
</p>
<div class="org-src-container">

<pre class="src src-python">Yes:
  <span style="color: #b0c4de;">print</span> (<span style="color: #ffa07a;">"This is much nicer.\n"</span>
         <span style="color: #ffa07a;">"Do it this way.\n"</span>)
  No:
    <span style="color: #b0c4de;">print</span> <span style="color: #ffa07a;">"""This is pretty ugly.</span>
<span style="color: #ffa07a;">Don't do this.</span>
<span style="color: #ffa07a;">"""</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-11" class="outline-3">
<h3 id="sec-3-11">Files and Sockets</h3>
<div class="outline-text-3" id="text-3-11">
<p class="info">
明确的关系文件和套接子当使用完。
</p>

<p>
Furthermore, while files and sockets are automatically closed when the
file object is destructed, tying the life-time of the file object to
the state of the file is poor practice, for several reasons:
</p>

<ul class="org-ul">
<li>There are no guarantees as to when the runtime will actually run the file's destructor. Different Python implementations use different memory management techniques, such as delayed Garbage Collection, which may increase the object's lifetime arbitrarily and indefinitely.
</li>
<li>Unexpected references to the file may keep it around longer than intended (e.g. in tracebacks of exceptions, inside globals, etc).
</li>
</ul>

<p>
The preferred way to manage files is using the "with" statement:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">with</span> <span style="color: #b0c4de;">open</span>(<span style="color: #ffa07a;">"hello.txt"</span>) <span style="color: #00ffff;">as</span> hello_file:
    <span style="color: #00ffff;">for</span> line <span style="color: #00ffff;">in</span> hello_file:
        <span style="color: #b0c4de;">print</span> line
</pre>
</div>

<p>
For file-like objects that do not support the "with" statement, use
<code>contextlib.closing()</code>:
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">import</span> contextlib

<span style="color: #00ffff;">with</span> contextlib.closing(urllib.urlopen(<span style="color: #ffa07a;">"http://www.python.org/"</span>)) <span style="color: #00ffff;">as</span> front_page:
    <span style="color: #00ffff;">for</span> line <span style="color: #00ffff;">in</span> front_page:
        <span style="color: #b0c4de;">print</span> line
</pre>
</div>
<p>
Legacy AppEngine code using Python 2.5 may enable the "with" statement using "from <span class="underline"><span class="underline">future</span></span> import with<sub>statement</sub>".
</p>
</div>
</div>

<div id="outline-container-sec-3-12" class="outline-3">
<h3 id="sec-3-12"><span class="todo TODO">TODO</span> Comments</h3>
<div class="outline-text-3" id="text-3-12">
<p class="info">
为临时代码使用TODO注释, 它是一种短期解决方案. 不算完美, 但够好了.
</p>
<p>
TODOs should include the string TODO in all caps, followed by the
name, e-mail address, or other identifier of the person who can best
provide context about the problem referenced by the TODO, in
parentheses. A colon is optional. A comment explaining what there is
to do is required. The main purpose is to have a consistent TODO
format that can be searched to find the person who can provide more
details upon request. A TODO is not a commitment that the person
referenced will fix the problem. Thus when you create a TODO, it is
almost always your name that is given.
</p>


<div class="org-src-container">

<pre class="src src-python"><span style="color: #ff7f24;"># </span><span style="color: #ffa07a;">TODO</span><span style="color: #ff7f24;">(kl@gmail.com): Use a "*" here for string repetition.</span>
<span style="color: #ff7f24;"># </span><span style="color: #ffa07a;">TODO</span><span style="color: #ff7f24;">(Zeke) Change this to use relations.</span>
</pre>
</div>

<p>
If your TODO is of the form "At a future date do something" make sure
that you either include a very specific date ("Fix by November 2009")
or a very specific event ("Remove this code when all clients can
handle XML responses.").
</p>
</div>
</div>

<div id="outline-container-sec-3-13" class="outline-3">
<h3 id="sec-3-13">Imports formatting</h3>
<div class="outline-text-3" id="text-3-13">
<p class="info">
每个导入应该独占一行
</p>
<p>
E.g.:
</p>
<div class="org-src-container">

<pre class="src src-python">Yes: <span style="color: #00ffff;">import</span> os
     <span style="color: #00ffff;">import</span> sys
No:  <span style="color: #00ffff;">import</span> os, sys
</pre>
</div>
<p>
Imports are always put at the top of the file, just after any module
comments and doc strings and before module globals and constants.
</p>

<p>
Imports should be grouped with the order being most generic to least
generic:
</p>

<ul class="org-ul">
<li>standard library imports
</li>
<li>third-party imports
</li>
<li>application-specific imports
</li>
</ul>

<p>
Within each grouping, imports should be sorted lexicographically,
ignoring case, according to each module's full package path.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">import</span> foo
<span style="color: #00ffff;">from</span> foo <span style="color: #00ffff;">import</span> bar
<span style="color: #00ffff;">from</span> foo.bar <span style="color: #00ffff;">import</span> baz
<span style="color: #00ffff;">from</span> foo.bar <span style="color: #00ffff;">import</span> Quux
<span style="color: #00ffff;">from</span> Foob <span style="color: #00ffff;">import</span> ar
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-14" class="outline-3">
<h3 id="sec-3-14">Statements</h3>
<div class="outline-text-3" id="text-3-14">
<p class="info">
通常每个语句应该独占一行
</p>
<p>
However, you may put the result of a test on the same line as the test
only if the entire statement fits on one line. In particular, you can
never do so with try/except since the try and except can't both fit on
the same line, and you can only do so with an if if there is no else.
</p>

<div class="org-src-container">

<pre class="src src-python">Yes:

  <span style="color: #00ffff;">if</span> foo: bar(foo)
No:

  <span style="color: #00ffff;">if</span> foo: bar(foo)
  <span style="color: #00ffff;">else:</span>   baz(foo)

  <span style="color: #00ffff;">try:</span>               bar(foo)
  <span style="color: #00ffff;">except</span> <span style="color: #b0c4de;">ValueError</span>: baz(foo)

  <span style="color: #00ffff;">try:</span>
      bar(foo)
  <span style="color: #00ffff;">except</span> <span style="color: #b0c4de;">ValueError</span>: baz(foo)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-15" class="outline-3">
<h3 id="sec-3-15">Access Control</h3>
<div class="outline-text-3" id="text-3-15">
<p class="info">
在Python中, 对于琐碎又不太重要的访问函数, 你应该直接使用公有变量来取代它们, 
这样可以避免额外的函数调用开销. 当添加更多功能时, 
你可以用属性(property)来保持语法的一致性.
</p>
<p>
On the other hand, if access is more complex, or the cost of accessing
the variable is significant, you should use function calls (following
the Naming guidelines) such as get<sub>foo</sub>() and set<sub>foo</sub>(). If the past
behavior allowed access through a property, do not bind the new
accessor functions to the property. Any code still attempting to
access the variable by the old method should break visibly so they are
made aware of the change in complexity.
</p>
</div>
</div>

<div id="outline-container-sec-3-16" class="outline-3">
<h3 id="sec-3-16">Naming</h3>
<div class="outline-text-3" id="text-3-16">
<div class="org-src-container">

<pre class="src src-python">module_name, package_name, ClassName, method_name, ExceptionName, function_name,
GLOBAL_CONSTANT_NAME, global_var_name, instance_var_name, function_parameter_name, 
local_var_name.
</pre>
</div>
</div>
<ul class="org-ul"><li><a id="sec-3-16-1" name="sec-3-16-1"></a>Names to Avoid<br  /><div class="outline-text-4" id="text-3-16-1">
<ul class="org-ul">
<li>single character names except for counters or iterators
</li>
<li>dashes (-) in any package/module name
</li>
<li><code>__double_leading_and_trailing_underscore__</code> names (reserved by Python)
</li>
</ul>
</div>
</li>
<li><a id="sec-3-16-2" name="sec-3-16-2"></a>Naming Convention<br  /><div class="outline-text-4" id="text-3-16-2">
<ul class="org-ul">
<li>"Internal" means internal to a module or protected or private within
a class.
</li>

<li>Prepending a single underscore (<code>_</code>) has some support for protecting
module variables and functions (not included with import * from).
Prepending a double underscore (<code>__</code>) to an instance variable or
method effectively serves to make the variable or method private to
its class (using name mangling).
</li>

<li>Place related classes and top-level functions together in a module.
Unlike Java, there is no need to limit yourself to one class per
module.
</li>

<li>Use CapWords for class names, but <code>lower_with_under.py</code> for module
names. Although there are many existing modules named CapWords.py,
this is now discouraged because it's confusing when the module
happens to be named after a class. ("wait &#x2013; did I write <code>import
  StringIO</code> or from <code>StringIO import StringIO</code>?")
</li>
</ul>

<p>
Guidelines derived from Guido's Recommendations
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">Type</th>
<th scope="col" class="left">Public</th>
<th scope="col" class="left">internal</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">Packages</td>
<td class="left"><code>lower_with_under</code></td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Modules</td>
<td class="left"><code>lower_with_under</code></td>
<td class="left"><code>_lower_with_under</code></td>
</tr>

<tr>
<td class="left">Classes</td>
<td class="left">CapWords</td>
<td class="left"><code>_CapWords</code></td>
</tr>

<tr>
<td class="left">Exceptions</td>
<td class="left">CapWords</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Functions</td>
<td class="left"><code>lower_with_under()</code></td>
<td class="left"><code>_lower_with_under()</code></td>
</tr>

<tr>
<td class="left">Global/Class Constants</td>
<td class="left"><code>CAPS_WITH_UNDER</code></td>
<td class="left"><code>_CAPS_WITH_UNDER</code></td>
</tr>

<tr>
<td class="left">Global/Class Variable</td>
<td class="left"><code>lower_with_under</code></td>
<td class="left"><code>_lower_with_under</code></td>
</tr>

<tr>
<td class="left">Instance Variable</td>
<td class="left"><code>lower_with_under</code></td>
<td class="left"><code>_lower_with_under(protected)</code> or <code>__lower_with_under(private)</code></td>
</tr>

<tr>
<td class="left">Method Names</td>
<td class="left"><code>lower_with_under()</code></td>
<td class="left"><code>_lower_with_under()(protected)</code> or <code>__lower_with_under()(private)</code></td>
</tr>

<tr>
<td class="left">Function/Method Parameters</td>
<td class="left"><code>lower_with_under</code></td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left">Local Variables</td>
<td class="left"><code>lower_with_under</code></td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</li></ul>
</div>

<div id="outline-container-sec-3-17" class="outline-3">
<h3 id="sec-3-17">Main</h3>
<div class="outline-text-3" id="text-3-17">
<p class="info">
即使是一个打算被用作脚本的文件,仅仅的导入不应该对脚本的主功能造成副作用。
主功能应该在一个main()函数中。
</p>
<p>
In Python, pydoc as well as unit tests require modules to be
importable. Your code should always check <code>if __name__ == '__main__':</code>
before executing your main program so that the main program is not
executed when the module is imported.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">def</span> <span style="color: #87cefa;">main</span>():
      ...

<span style="color: #00ffff;">if</span> <span style="color: #b0c4de;">__name__</span> == <span style="color: #ffa07a;">'__main__'</span>:
    main()
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Shi Shougang</p>
<p class="date">Created: 2016-02-03 Wed 22:49</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.3.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
