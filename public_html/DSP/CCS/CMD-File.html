<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>CMD File</title>
<!-- 2016-05-26 Thu 22:12 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Shi Shougang" />
<link href="../../assets/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="../../assets/bootstrap-responsive.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../../assets/stylesheet.css" />
<script src="assets/js/bootstrap.min.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">CMD File</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">File Reference</a></li>
<li><a href="#sec-2">Linker Overview</a></li>
<li><a href="#sec-3">Linker Options</a>
<ul>
<li><a href="#sec-3-1">Wild Cards in File, Section, and Symbol Patterns</a></li>
<li><a href="#sec-3-2">Define Heap Size (<code>--heap_size</code> Option)</a></li>
<li><a href="#sec-3-3">Define Stack Size (<code>--stack_size</code> Option)</a></li>
<li><a href="#sec-3-4">Constants in Linker Command Files</a></li>
<li><a href="#sec-3-5">The MEMORY Directive</a></li>
<li><a href="#sec-3-6">The SECTIONS Directive</a></li>
<li><a href="#sec-3-7">Default Allocation Algorithm</a></li>
</ul>
</li>
<li><a href="#sec-4">Linking C/C++ Code</a>
<ul>
<li><a href="#sec-4-1">Run-Time Initialization</a></li>
<li><a href="#sec-4-2">Specifying Where to Allocate Sections in Memory</a></li>
<li><a href="#sec-4-3">A Sample Linker Command File</a></li>
</ul>
</li>
<li><a href="#sec-5">More example for reference</a>
<ul>
<li><a href="#sec-5-1">Exmaple 1</a></li>
<li><a href="#sec-5-2">Exmaple 2(C6A816x.cmd)</a></li>
<li><a href="#sec-5-3">Exmaple 3(C6747.cmd)</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
三部分组成：
</p>
<ul class="org-ul">
<li>输入/输出定义：这一部分，可 以通过ccs的“Build Option&#x2026;&#x2026;..”菜单设置
.obj 链接的目标文件
.lib 链接的库文件
.map 生成的交叉索引文件
.out 生成的可执行代码
</li>
<li>MEMORY命令：描述系统实际的硬件资源
</li>
<li>SECTION命 令：描述“段”如何定
</li>
</ul>


<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">File Reference</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>Linker CMD Files for CCS
<a href="http://processors.wiki.ti.com/index.php/Linker_CMD_Files_for_CCS">http://processors.wiki.ti.com/index.php/Linker_CMD_Files_for_CCS</a>
</li>

<li>TMS320C6000 Assembly Language Tools
Chapter5: Linking C/C++ Code

<p>
pdf: <a href="./spru186v.pdf">TMS320C6000 Assembly Language Tools</a>
</p>
</li>
<li>TMS320C6000 Optimizing Compiler v 7.3
Chapter7: Linker Description

<p>
pdf: <a href="./spru187t.pdf">TMS320C6000 Optimizing Compiler v 7.3</a>
</p>
</li>
<li>CMD文件配置详解
</li>
</ul>
<p>
<a href="http://read.pudn.com/downloads153/ebook/669003/CMD%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3.pdf">http://read.pudn.com/downloads153/ebook/669003/CMD%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3.pdf</a>
</p>
</div>
</div>


<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Linker Overview</h2>
<div class="outline-text-2" id="text-2">
<p>
Two powerful directives, MEMORY and SECTIONS, allow you to:
</p>

<p>
• Allocate sections into specific areas of memory
• Combine object file sections
• Define or redefine global symbols at link time
</p>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Linker Options</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li><code>--heap_size</code> 
<code>-heap</code> Sets heap size (for the dynamic memory allocation in C) to
size bytes and defines a global symbol that specifies the
heap size. Default = 1K bytes. Section 7.4.11<sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> 
</li>
<li><code>--stack_size</code>
 <code>-stack</code> Sets C system stack size to size bytes and defines
a global symbol that specifies the stack size.
Default = 1K bytes. Section 7.4.26<sup><a id="fnr.1.100" name="fnr.1.100" class="footref" href="#fn.1">1</a></sup>
</li>
</ul>
</div>
<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Wild Cards in File, Section, and Symbol Patterns</h3>
<div class="outline-text-3" id="text-3-1">
<p>
The linker allows file, section, and symbol names to be specified using the asterisk (*) and question mark
(?) wild cards. Using * matches any number of characters and using ?
matches a single character.
</p>
</div>
<ul class="org-ul"><li><a id="sec-3-1-1" name="sec-3-1-1"></a>Example<br  /><div class="outline-text-4" id="text-3-1-1">
<div class="org-src-container">

<pre class="src src-c">SECTIONS
{
.fast_code: { *.obj(*fast*) } &gt; FAST_MEM
.vectors : { vectors.obj(.vector:part1:*) &gt; 0xFFFFFF00
.str_code : { rts*.lib&lt;str*.obj&gt;(.text) } &gt; S1ROM
}
</pre>
</div>
</div>
</li></ul>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Define Heap Size (<code>--heap_size</code> Option)</h3>
<div class="outline-text-3" id="text-3-2">
<p>
The C/C++ compiler uses an uninitialized section called <code>.sysmem</code> for
the C run-time memory pool used by <code>malloc()</code>. You can set the size of
this memory pool at link time by using the &#x2013;heap<sub>size</sub> option. The
syntax for the &#x2013;heap<sub>size</sub> option is:
</p>

<p>
<code>--heap_size= size</code>
</p>

<p>
The size must be a constant. This example defines a 4K byte heap:
</p>
<div class="org-src-container">

<pre class="src src-c">cl6x --run_linker --heap_size=0x1000 <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">defines a 4k heap (.sysmem section)</span><span style="color: #ff7f24;">*/</span>
</pre>
</div>
<p>
The linker creates the <code>.sysmem</code> section only if there is a .sysmem section in an input file.
The linker also creates a global symbol _<sub>SYSMEM</sub><sub>SIZE</sub> and assigns it a
value equal to the size of the heap. The <b>default</b> size is 1K bytes.
</p>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">Define Stack Size (<code>--stack_size</code> Option)</h3>
<div class="outline-text-3" id="text-3-3">
<p>
The TMS320C6000 C/C++ compiler uses an uninitialized section,
<code>.stack</code>, to allocate space for the run-time stack. The syntax for the
<code>--stack_size</code> option is:
</p>

<p>
<code>--stack_size= size</code>
The size must be a constant and is in bytes. This example defines a 4K byte stack:
</p>
<div class="org-src-container">

<pre class="src src-c">cl6x --run_linker --stack_size=0x1000 <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">defines a 4K heap (.stack section)</span><span style="color: #ff7f24;">*/</span>
</pre>
</div>

<p>
When the linker defines the .stack section, it also defines a global
symbol, <code>__STACK_SIZE</code>, and assigns it a value equal to the size of the
section. The <b>default</b> software stack size is 1K bytes.
</p>
</div>
</div>

<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4">Constants in Linker Command Files</h3>
<div class="outline-text-3" id="text-3-4">
</div><ul class="org-ul"><li><a id="sec-3-4-1" name="sec-3-4-1"></a>Examples<br  /><div class="outline-text-4" id="text-3-4-1">
<div class="org-src-container">

<pre class="src src-c">Format            Decimal    Octal    Hexadecimal
<span style="color: #98fb98;">Assembler</span> <span style="color: #eedd82;">format</span>  32         40q      020h
C format          32         040      0x20
</pre>
</div>
</div>
</li></ul>
</div>

<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5">The MEMORY Directive</h3>
<div class="outline-text-3" id="text-3-5">
<p>
The linker determines where output sections are allocated into memory; it must have a model of target
memory to accomplish this. The MEMORY directive allows you to specify a model of target memory so
that you can define the types of memory your system contains and the
address ranges they occupy.
</p>

<p>
After you use MEMORY to define a
memory model, you can use the SECTIONS directive to allocate output
sections into defined memory.
</p>
</div>
<ul class="org-ul"><li><a id="sec-3-5-1" name="sec-3-5-1"></a>MEMORY Directive Syntax<br  /><div class="outline-text-4" id="text-3-5-1">
<p>
The MEMORY directive in Example defines a
system that has 4K bytes of fast external memory at address 0x0000 0000, 2K bytes of slow external
memory at address 0x0000 1000 and 4K bytes of slow external memory at address 0x1000 0000. It also
demonstrates the use of memory range expressions as well as
start/end/size address operators
</p>

<p>
<b>Example</b>
</p>
<div class="org-src-container">

<pre class="src src-c"><span style="color: #ff7f24;">/********************************************************/</span>
<span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">Sample command file with MEMORY directive </span><span style="color: #ff7f24;">*/</span>
<span style="color: #ff7f24;">/********************************************************/</span>
file1.obj file2.obj <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">Input files </span><span style="color: #ff7f24;">*/</span>
--output_file=prog.out <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">Options </span><span style="color: #ff7f24;">*/</span>
<span style="color: #b0c4de;">#define</span> <span style="color: #eedd82;">BUFFER</span> 0
MEMORY
{
FAST_MEM (RX): origin = 0x00000000 length = 0x00001000 + BUFFER
SLOW_MEM (RW): origin = end(FAST_MEM) length = 0x00001800 - size(FAST_MEM)
EXT_MEM (RX): origin = 0x10000000 length = size(FAST_MEM)
}
</pre>
</div>

<p>
The general syntax for the MEMORY directive is:
</p>
<div class="org-src-container">

<pre class="src src-c">MEMORY
{
name 1 [( attr )] : origin = expression , length = expression [, fill = constant]
.
.
name n [( attr )] : origin = expression , length = expression [, fill = constant]
}
</pre>
</div>

<ul class="org-ul">
<li>attr 
<b>R</b> specifies that the memory can be read.
<b>W</b> specifies that the memory can be written to.
<b>X</b> specifies that the memory can contain executable code.
<b>I</b> specifies that the memory can be initialized.
</li>
<li>origin
specifies the starting address of a memory range; enter as origin,
org, or o. The value, specified in bytes, is an expression of 32-bit
constants, which can be decimal, octal, or hexadecimal.
</li>
<li>length
specifies the length of a memory range; enter as length, len, or l.
The value, specified in bytes, is an expression of 32-bit constants,
</li>
<li>fill
specifies a fill character for the memory range; enter as fill or f.
Fills are optional. The value is a integer constant and can be
decimal, octal, or hexadecimal. The fill value is used to fill areas
of the memory range that are not allocated to a section
</li>
</ul>
<p class="info">Filling Memory Ranges: If you specify fill values for large memory ranges, your output file will be very large because
filling a memory range (even with 0s) causes raw data to be generated for all unallocated
blocks of memory in the range.  </p>
<p>
 <b>Example</b>
The following example specifies a memory range with the R and W
attributes and a fill constant of 0FFFFFFFFh
</p>
<div class="org-src-container">

<pre class="src src-c">MEMORY
{
RFILE (RW) : o = 0x00000020, l = 0x00001000, f = 0xFFFFFFFF
}
</pre>
</div>
</div>
</li>
<li><a id="sec-3-5-2" name="sec-3-5-2"></a>Expressions and Address Operators<br  /><div class="outline-text-4" id="text-3-5-2">
<p>
Three new address operators have been added for referencing memory range properties from prior
memory range entries:
</p>

<ul class="org-ul">
<li>START(MR) Returns start address for previously defined memory range MR.
</li>
<li>SIZE(MR) Returns size of previously defined memory range MR.
</li>
<li>END(MR) Returns end address for previously defined memory range MR.
<b>Example</b>
</li>
</ul>
<div class="org-src-container">

<pre class="src src-c"><span style="color: #ff7f24;">/********************************************************/</span>
<span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">Sample command file with MEMORY directive </span><span style="color: #ff7f24;">*/</span>
<span style="color: #ff7f24;">/********************************************************/</span>
file1.obj file2.obj <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">Input files </span><span style="color: #ff7f24;">*/</span>
--output_file=prog.out <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">Options </span><span style="color: #ff7f24;">*/</span>
<span style="color: #b0c4de;">#define</span> <span style="color: #eedd82;">ORIGIN</span> 0x00000000
<span style="color: #b0c4de;">#define</span> <span style="color: #eedd82;">BUFFER</span> 0x00000200
<span style="color: #b0c4de;">#define</span> <span style="color: #eedd82;">CACHE</span> 0x0001000
MEMORY
{
FAST_MEM (RX): origin = ORIGIN + CACHE length = 0x00001000 + BUFFER
SLOW_MEM (RW): origin = end(FAST_MEM) length = 0x00001800 - size(FAST_MEM)
EXT_MEM (RX): origin = 0x10000000 length = size(FAST_MEM) - CACHE
}
</pre>
</div>
</div>
</li></ul>
</div>
<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6">The SECTIONS Directive</h3>
<div class="outline-text-3" id="text-3-6">
</div><ul class="org-ul"><li><a id="sec-3-6-1" name="sec-3-6-1"></a>SECTIONS Directive Syntax<br  /><div class="outline-text-4" id="text-3-6-1">
<div class="org-src-container">

<pre class="src src-c">SECTIONS
{
<span style="color: #7fffd4;">name</span> : [property [, property] [, property] . . . ]
name : [property [, property] [, property] . . . ]
name : [property [, property] [, property] . . . ]
}
</pre>
</div>
<p>
Possible properties for a section are as follows:
</p>
<ul class="org-ul">
<li>Load allocation defines where in memory the section is to be loaded.
Syntax: load = allocation  or allocation  or &gt; allocation
</li>

<li>Run allocation defines where in memory the section is to be run.
Syntax: run = allocation or run &gt; allocation
</li>
<li>Input sections defines the input sections (object files) that constitute the output section.
Syntax: { input<sub>sections</sub> }
</li>
<li>Section type defines flags for special section types. 
Syntax: type = COPY or type = DSECT or type = NOLOAD
</li>
<li>Fill value defines the value used to fill uninitialized holes. 
Syntax: fill = value or name : [properties = value]
</li>
</ul>
</div>
</li>

<li><a id="sec-3-6-2" name="sec-3-6-2"></a>Allocation<br  /><div class="outline-text-4" id="text-3-6-2">
<ul class="org-ul">
<li>Binding allocates a section at a specific address.
<code>.text: load = 0x1000</code>
</li>
<li>Named memory allocates the section into a range defined in the MEMORY directive with the specified
name (like SLOW<sub>MEM</sub>) or attributes.
<code>.text: load &gt; SLOW_MEM</code>
</li>
<li>Alignment uses the align or palign keyword to specify that the
section must start on an address boundary.
<code>.text: align = 0x100</code>
</li>
<li>Blocking uses the block keyword to specify that the section must fit
between two address boundaries: if the section is too big, it starts on an address boundary.
<code>.text: block(0x100)</code>
</li>
</ul>
</div>
</li>

<li><a id="sec-3-6-3" name="sec-3-6-3"></a>Symbols Defined by the Linker<br  /><div class="outline-text-4" id="text-3-6-3">
<ul class="org-ul">
<li>.text is assigned the first address of the .text output section.
(It marks the beginning of executable code.)
</li>
<li>etext is assigned the first address following the .text output section.
(It marks the end of executable code.)
</li>
<li>.data is assigned the first address of the .data output section.
(It marks the beginning of initialized data tables.)
</li>
<li>edata is assigned the first address following the .data output section.
(It marks the end of initialized data tables.)
</li>
<li>.bss is assigned the first address of the .bss output section.
(It marks the beginning of uninitialized data.)
</li>
<li>end is assigned the first address following the .bss output section.
(It marks the end of uninitialized data.)
</li>
</ul>
</div>
</li></ul>
</div>


<div id="outline-container-sec-3-7" class="outline-3">
<h3 id="sec-3-7">Default Allocation Algorithm</h3>
<div class="outline-text-3" id="text-3-7">
<p>
If you do not use the MEMORY and SECTIONS directives, the linker allocates output sections as though
the definitions in Example were specified.
 <b>Example Default Allocation for TMS320C6000 Devices</b>
</p>
<div class="org-src-container">

<pre class="src src-c">MEMORY
{
<span style="color: #7fffd4;">RAM</span> : origin = 0x00000001, length = 0xFFFFFFFE
}
SECTIONS
{
.text : ALIGN(32) {} &gt; RAM
.<span style="color: #00ffff;">const</span> : ALIGN(8) {} &gt; RAM
.data : ALIGN(8) {} &gt; RAM
.bss : ALIGN(8) {} &gt; RAM
.cinit : ALIGN(4) {} &gt; RAM ; cflag <span style="color: #98fb98;">option</span> <span style="color: #eedd82;">only</span>
.pinit : ALIGN(4) {} &gt; RAM ; cflag <span style="color: #98fb98;">option</span> <span style="color: #eedd82;">only</span>
.stack : ALIGN(8) {} &gt; RAM ; cflag <span style="color: #98fb98;">option</span> <span style="color: #eedd82;">only</span>
.far : ALIGN(8) {} &gt; RAM ; cflag <span style="color: #98fb98;">option</span> <span style="color: #eedd82;">only</span>
.sysmem: ALIGN(8) {} &gt; RAM ; cflag <span style="color: #98fb98;">option</span> <span style="color: #eedd82;">only</span>
.<span style="color: #00ffff;">switch</span>: ALIGN(4) {} &gt; RAM ; cflag <span style="color: #98fb98;">option</span> <span style="color: #eedd82;">only</span>
.cio : ALIGN(4) {} &gt; RAM ; cflag <span style="color: #98fb98;">option</span> <span style="color: #eedd82;">only</span>
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Linking C/C++ Code</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">Run-Time Initialization</h3>
<div class="outline-text-3" id="text-4-1">
<p>
C/C++ programs require initialization of the run-time environment before execution of the program itself
may begin. This initialization is performed by a bootstrap routine. This routine is responsible for creating
the stack, initializing global variables, and calling main(). The bootstrap routine should be the entry point
for the program, and it typically should be the RESET interrupt handler. The bootstrap routine is
responsible for the following tasks:
</p>

<ol class="org-ol">
<li>Set up the stack by initializing SP
</li>
<li>Set up the data page pointer DP (for architectures that have one)
</li>
<li>Set configuration registers
</li>
<li>Process the .cinit table to autoinitialize global variables (when using the &#x2013;rom<sub>model</sub> option)
</li>
<li>Process the .pinit table to construct global C++ objects.
</li>
<li>Call main with appropriate arguments
</li>
<li>Call exit when main returns
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">Specifying Where to Allocate Sections in Memory</h3>
<div class="outline-text-3" id="text-4-2">
<p>
（1）被初始化的“SECTIONS”(包括数据表和可执行代码)
</p>

<ul class="org-ul">
<li>.text 它包括所有的可执行代码和常数，必须放在程序页； 
</li>
<li>.cinit 它包括初始化的变量和常量表,要求放在程序页； 
</li>
<li>.pinit 它包括全局构造器(C++)初始化的变量和常量表，要求放在程序页； 
</li>
<li>.const 它包括字符串、声明、以及被明确初始化过的全局和静态变量，要求放在低地址的数 据页； 
</li>
<li>.econst 它是在使用大存储器模式时使用的，包括字符串、声明、以及被明确初始化过的全 局变量和静态变量，可以放在数据页的任何地方。 
</li>
<li>.switch 它包括为转换声明设置的表格，可以放在程序页也可以放在低地址的数据页。 
</li>
</ul>

<p>
（2）未被初始化的“SECTIONS”（为程序运行中创建和存放的变量在存储器中保留空间)
</p>

<ul class="org-ul">
<li>.bss 它为全局变量和静态变量保留空间。在程序开始运行时，C 导入路径把数据从.cinit 节复 制出去然后存在.bss节中，要求放在低地址的数据页； 
</li>
<li>.ebss 它是在远(far)访问(只用于 C)和大存储模式下使用，它为全局变量和静态变量保留空间。 在程序开始运行时，C 导入路径把数据从.cinit 段复制出去然后存在.ebss 节中，可以放在数据页的任何地方； 
</li>
<li>.stack为C系统堆栈保留空间，这部分存储器为用来将声明传给函数及为局部变量留出空间， 要求放在低地址的数据页； 
</li>
<li>.system 动态存储器分配保留空间。这个空间用于 malloc 函数，如果不使用
malloc 函数，这个段的大小就是 0，要求放在低地址的数据页； 
</li>
<li>.esystem 动态存储器分配保留空间，这个空间用于外部 malloc 函数，如果不使用外部 malloc函数，这个段的大小就是 0，可以放在数据页的任何地方
</li>
</ul>

<p>
Table 5-1 summarizes the initialized sections created under the COFF
ABI mode. Table 5-2 summarizes the initialized sections created under
the EABI mode. Table 5-3 summarizes the uninitialized sections. Be
aware that the COFF ABI .cinit and .pinit (.init<sub>array</sub> in EABI) tables
have different formats in EABI.
</p>

<p>
<b>Table 5-1. Initialized Sections Created by the Compiler for COFFABI</b>
Name      Contents
</p>
<ul class="org-ul">
<li><code>.args</code> Command argument for host-based loader; read-only (see the &#x2013;arg<sub>size</sub> option)
</li>
<li><code>.cinit</code> Tables for explicitly initialized global and static variables
</li>
<li>.const Global and static const variables that are explicitly initialized and contain string literals
</li>
<li>.pinit Table of constructors to be called at startup
</li>
<li>.ppdata Data tables for compiler-based profiling (see the &#x2013;gen<sub>profile</sub><sub>info</sub> option)
</li>
<li>.ppinfo Correlation tables for compiler-based profiling ( see the &#x2013;gen<sub>profile</sub><sub>info</sub> option)
</li>
<li>.switch Jump tables for large switch statements
</li>
<li>.text Executable code and constants

<p>
<b>Table 5-2. Initialized Sections Created by the Compiler for EABI</b>
</p>
</li>
</ul>
<p>
Name   Contents
</p>
<ul class="org-ul">
<li>.args  Command argument for host-based loader; read-only (see the &#x2013;arg<sub>size</sub> option)
</li>
<li>.binit Boot time copy tables (See the TMS320C6000 Assembly Language
Tools User's Guide for information on BINIT in linker command files.)
</li>
<li>.cinit  In EABI mode, the compiler does not generate a .cinit
section. However, when the &#x2013;rom<sub>mode</sub> linker option is specified, the linker creates this
section, which contains tables for <b>explicitly initialized global</b> and <b>static variables</b>.
</li>
<li>.const  Far, const global and static variables, and string constants
</li>
<li>.c6xabi.exidx Index table for exception handling; read-only (see &#x2013;exceptions option)
</li>
<li>.c6xabi.extab  Unwinded instructions for exception handling; read-only (see &#x2013;exceptions option)
</li>
<li>.fardata Far non-const global and static variables that are explicitly initialized
</li>
<li>.init<sub>array</sub> Table of constructors to be called at startup
</li>
<li>.name.load Compressed image of section name; read-only (See the
TMS320C6000 Assembly Language Tools User's Guide for information on copy tables.)
</li>
<li>.neardata Near non-const global and static variables that are explicitly initialized
</li>
<li>.ppdata Data tables for compiler-based profiling (see the &#x2013;gen<sub>profile</sub><sub>info</sub> option)
</li>
<li>.ppinfo Correlation tables for compiler-based profiling (see the &#x2013;gen<sub>profile</sub><sub>info</sub> option)
</li>
<li>.rodata Global and static variables that have near and const qualifiers
</li>
<li>.switch Jump tables for large switch statements
</li>
<li>.text Executable code and constants

<p>
<b>Table 5-3. Uninitialized Sections Created by the Compiler for Both ABIs</b>
</p>
</li>
</ul>
<p>
Name   Contents
</p>
<ul class="org-ul">
<li>.bss Global and static variables
</li>
<li>.far Global and static variables declared far
</li>
<li>.stack Stack
</li>
<li>.sysmem Memory for malloc functions (heap)
</li>
</ul>

<p>
When you link your program, you must specify where to allocate the sections in memory. In general,
initialized sections are linked into ROM or RAM; uninitialized sections are linked into RAM. With the
exception of code sections, the initialized and uninitialized sections created by the compiler cannot be
allocated into internal program memory
</p>
</div>
</div>

<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3">A Sample Linker Command File</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Example 5-2 shows a typical linker command file that links a C program. The command file in this
example is named lnk.cmd and lists several linker options:
</p>

<ul class="org-ul">
<li>&#x2013;rom<sub>model</sub> Tells the linker to use autoinitialization at run time.
</li>
<li>&#x2013;heap<sub>size</sub> Tells the linker to set the C heap size at 0x2000 bytes.
</li>
<li>&#x2013;stack<sub>size</sub> Tells the linker to set the stack size to 0x0100 bytes.
</li>
<li>&#x2013;library Tells the linker to use an archive library file, rts6200.lib, for input.
<b>Example 5-2. Linker Command File</b>
</li>
</ul>
<div class="org-src-container">

<pre class="src src-c">--rom_model
--heap_size=0x2000
--stack_size=0x0100
--library=rts6200.lib
MEMORY
{
<span style="color: #7fffd4;">VECS</span>: o = 0x00000000 l = 0x000000400 <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">reset &amp; interrupt vectors </span><span style="color: #ff7f24;">*/</span>
PMEM: o = 0x00000400 l = 0x00000FC00 <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">intended for initialization </span><span style="color: #ff7f24;">*/</span>
BMEM: o = 0x80000000 l = 0x000010000 <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">.bss, .sysmem, .stack, .cinit </span><span style="color: #ff7f24;">*/</span>
}
SECTIONS
{
vectors &gt; VECS
.text &gt; PMEM
.data &gt; BMEM
.stack &gt; BMEM
.bss &gt; BMEM
.sysmem &gt; BMEM
.cinit &gt; BMEM
.<span style="color: #00ffff;">const</span> &gt; BMEM
.cio &gt; BMEM
.far &gt; BMEM
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">More example for reference</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">Exmaple 1</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">

<pre class="src src-c">-stack          0x00004000      <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">Stack Size </span><span style="color: #ff7f24;">*/</span>
-heap           0x00004000      <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">Heap Size </span><span style="color: #ff7f24;">*/</span>

MEMORY
{
    <span style="color: #7fffd4;">VECS</span>:       o = 0x402F0000  l = 0x00000080
    ARMRAM:     o = 0x402F0080  l = 0x0000FF80  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">64 kBytes  </span><span style="color: #ff7f24;">*/</span>
    OCMCSRAM0:  o = 0x40300000  l = 0x00040000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">256 kBytes </span><span style="color: #ff7f24;">*/</span>
    OCMCSRAM1:  o = 0x40400000  l = 0x00040000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">256 kBytes </span><span style="color: #ff7f24;">*/</span>
    DDR3_0:     o = 0x80000000  l = 0x20000000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">512 MBytes </span><span style="color: #ff7f24;">*/</span>
    DDR3_1:     o = 0xC0000000  l = 0x20000000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">512 MBytes </span><span style="color: #ff7f24;">*/</span>
}

SECTIONS
{
    .bss        &gt;   OCMCSRAM0
    .cinit      &gt;   OCMCSRAM0
    .cio        &gt;   OCMCSRAM0
    .<span style="color: #00ffff;">const</span>      &gt;   OCMCSRAM0
    .stack      &gt;   OCMCSRAM1
    .sysmem     &gt;   OCMCSRAM0
    .text       &gt;   OCMCSRAM0
    .ddr2       &gt;   OCMCSRAM0
}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2">Exmaple 2(C6A816x.cmd)</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">

<pre class="src src-c">-heap  0x2000
-stack 0x2000

MEMORY
{
    <span style="color: #98fb98;">DSPL2</span>     <span style="color: #eedd82;">o</span> = 0x00800000  l = 0x00040000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">256kB DSP L2 RAM </span><span style="color: #ff7f24;">*/</span>
    DSPL1P    o = 0x00E00000  l = 0x00008000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32kB DSP L1 Program Cache/RAM </span><span style="color: #ff7f24;">*/</span>
    DSPL1D    o = 0x00F00000  l = 0x00008000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32kB DSP L1 Data Cache/RAM </span><span style="color: #ff7f24;">*/</span>
    L3OCMC0   o = 0x40300000  l = 0x00040000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">256kB L3 OCMC SRAM </span><span style="color: #ff7f24;">*/</span>
    L3OCMC1   o = 0x40400000  l = 0x00040000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">256kB L3 OCMC SRAM </span><span style="color: #ff7f24;">*/</span>
    SHDSPL2   o = 0x40800000  l = 0x00040000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">256kB Shared DSP L2 RAM </span><span style="color: #ff7f24;">*/</span>
    SHDSPL1P  o = 0x40E00000  l = 0x00008000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32kB Shared DSP L1 Program Cache/RAM </span><span style="color: #ff7f24;">*/</span>
    SHDSPL1D  o = 0x40F00000  l = 0x00008000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32kB Shared DSP L1 Data Cache/RAM </span><span style="color: #ff7f24;">*/</span>
    DDR0      o = 0x80000000  l = 0x40000000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">1GB external DDR Bank 0 </span><span style="color: #ff7f24;">*/</span>
    DDR1      o = 0xC0000000  l = 0x40000000  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">1GB external DDR Bank 1 </span><span style="color: #ff7f24;">*/</span>
}

SECTIONS
{
        .text          &gt;  DDR0
        .stack         &gt;  DDR0
        .bss           &gt;  DDR0
        .cio           &gt;  DDR0
        .<span style="color: #00ffff;">const</span>         &gt;  DDR0
        .data          &gt;  DDR0
        .<span style="color: #00ffff;">switch</span>        &gt;  DDR0
        .sysmem        &gt;  DDR0
        .far           &gt;  DDR0
  .args          &gt;  DDR0
        .ppinfo        &gt;  DDR0
        .ppdata        &gt;  DDR0

  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">TI-ABI or COFF sections </span><span style="color: #ff7f24;">*/</span>
        .pinit         &gt;  DDR0
        .cinit         &gt;  DDR0

  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">EABI sections </span><span style="color: #ff7f24;">*/</span>
  .binit         &gt;  DDR0
        .init_array    &gt;  DDR0
  .neardata      &gt;  DDR0
        .fardata       &gt;  DDR0
        .rodata        &gt;  DDR0
        .c6xabi.exidx  &gt;  DDR0
        .c6xabi.extab  &gt;  DDR0
}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3">Exmaple 3(C6747.cmd)</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">

<pre class="src src-c">-stack 0x2000
-heap 0x4000

MEMORY
{
        <span style="color: #98fb98;">DSPL2ROM</span>          <span style="color: #eedd82;">o</span> = 0x00700000        l = 0x00010000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">1MB L2 Internal ROM </span><span style="color: #ff7f24;">*/</span>                
        DSPL2RAM          o = 0x00800000        l = 0x00040000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">256kB L2 Internal RAM </span><span style="color: #ff7f24;">*/</span>              
        DSPL1PRAM         o = 0x00E00000        l = 0x00008000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32kB L1 Internal Program RAM </span><span style="color: #ff7f24;">*/</span>        
        DSPL1DRAM         o = 0x00F00000        l = 0x00008000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32kB L1 Internal Data RAM </span><span style="color: #ff7f24;">*/</span>           
        SHDSPL2ROM      o = 0x11700000  l = 0x00100000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">1MB L2 Shared Internal ROM </span><span style="color: #ff7f24;">*/</span>         
        SHDSPL2RAM      o = 0x11800000  l = 0x00040000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">256kB L2 Shared Internal RAM </span><span style="color: #ff7f24;">*/</span>       
        SHDSPL1PRAM     o = 0x11E00000  l = 0x00008000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32kB L1 Shared Internal Program RAM </span><span style="color: #ff7f24;">*/</span>
        SHDSPL1DRAM     o = 0x11F00000  l = 0x00008000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32kB L1 Shared Internal Data RAM </span><span style="color: #ff7f24;">*/</span>    
        EMIFASDRAM      o = 0x40000000  l = 0x08000000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">64MB SDRAM Data (CS0) </span><span style="color: #ff7f24;">*/</span>              
        EMIFACS2          o = 0x60000000        l = 0x02000000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32MB Async Data (CS2) </span><span style="color: #ff7f24;">*/</span>              
        EMIFACS3          o = 0x62000000        l = 0x02000000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32MB Async Data (CS3) </span><span style="color: #ff7f24;">*/</span>              
        EMIFACS4          o = 0x64000000        l = 0x02000000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32MB Async Data (CS4) </span><span style="color: #ff7f24;">*/</span>              
        EMIFACS5          o = 0x66000000        l = 0x02000000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">32MB Async Data (CS5) </span><span style="color: #ff7f24;">*/</span>              
        SHRAM               o = 0x80000000      l = 0x00020000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">128kB Shared RAM </span><span style="color: #ff7f24;">*/</span>                   
        EMIFBSDRAM      o = 0xC0000000  l = 0x10000000     <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">256MB SDRAM Data </span><span style="color: #ff7f24;">*/</span>                   
}                                                                       

SECTIONS
{
        .text          &gt;  SHRAM
        .stack         &gt;  SHRAM
        .bss           &gt;  SHRAM
        .cio           &gt;  SHRAM
        .<span style="color: #00ffff;">const</span>         &gt;  SHRAM
        .data          &gt;  SHRAM
        .<span style="color: #00ffff;">switch</span>        &gt;  SHRAM
        .sysmem        &gt;  SHRAM
        .far           &gt;  SHRAM
  .args          &gt;  SHRAM
        .ppinfo        &gt;  SHRAM
        .ppdata        &gt;  SHRAM

  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">COFF sections </span><span style="color: #ff7f24;">*/</span>
        .pinit         &gt;  SHRAM
        .cinit         &gt;  SHRAM

  <span style="color: #ff7f24;">/* </span><span style="color: #ff7f24;">EABI sections </span><span style="color: #ff7f24;">*/</span>
  .binit         &gt;  SHRAM
        .init_array    &gt;  SHRAM
  .neardata      &gt;  SHRAM
        .fardata       &gt;  SHRAM
        .rodata        &gt;  SHRAM
        .c6xabi.exidx  &gt;  SHRAM
        .c6xabi.extab  &gt;  SHRAM
}
</pre>
</div>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
TMS320C6000 Assembly Language Tools
</p></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Shi Shougang</p>
<p class="date">Created: 2016-05-26 Thu 22:12</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.3.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
